<!DOCTYPE html>
<html lang="pl-PL">
<head>
    <link rel="stylesheet" type="text/css"
          href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/css/bootstrap.min.css"
          integrity="sha384-PsH8R72JQ3SOdhVi3uxftmaW6Vc51MKb0q5P2rRUpPvrszuE4W1povHYgTpBfshb" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.3/umd/popper.min.js"
            integrity="sha384-vFJXuSJphROIrBnz7yo7oB41mKfc8JzQZiCq4NCceLEaO4IHwicKwpJf9c9IpFgh"
            crossorigin="anonymous"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-beta.2/js/bootstrap.min.js"
            integrity="sha384-alpBpkh1PFOepccYVYDB4do5UnbKysX5WZXm3XxPqe5iKTfUKjNkCk9SaVuEZflJ"
            crossorigin="anonymous"></script>
    <style>
        * {
            box-sizing: border-box;
        }

        body {
            font: 16px Arial;
        }

        .autocomplete {
            /*the container must be positioned relative:*/
            position: relative;
            display: inline-block;
        }

        input {
            border: 1px solid transparent;
            background-color: #f1f1f1;
            padding: 10px;
            font-size: 16px;
        }

        input[type=text] {
            background-color: #f1f1f1;
            width: 100%;
        }

        input[type=submit] {
            background-color: DodgerBlue;
            color: #fff;
        }

        .autocomplete-items {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            z-index: 99;
            /*position the autocomplete items to be the same width as the container:*/
            top: 100%;
            left: 0;
            right: 0;
        }

        .autocomplete-items div {
            padding: 10px;
            cursor: pointer;
            background-color: #fff;
            border-bottom: 1px solid #d4d4d4;
        }

        .autocomplete-items div:hover {
            /*when hovering an item:*/
            background-color: #e9e9e9;
        }

        .autocomplete-active {
            /*when navigating through the items using the arrow keys:*/
            background-color: DodgerBlue !important;
            color: #ffffff;
        }
    </style>
</head>
<body>

<form autocomplete="off" action="/api/search/eve-org">
    <div class="autocomplete" style="width:30%;">
        <input id="phrase" type="text" name="phrase" placeholder="Nazwa">
    </div>
    <input type="submit" value="Szukaj">
    <div>
        <div class="custom-control custom-checkbox">
            <input type="checkbox" id="checkEve" onclick="buttonCheckEve()">
            <label for="checkEve"> Nazwy wydarzeń </label>
        </div>

        <div class="custom-control custom-checkbox">
            <input type="checkbox" id="checkOrg" onclick="buttonCheckOrg()">
            <label for="checkOrg"> Nazwy organizatorów </label>
        </div>

        <div class="custom-control custom-checkbox">
            <input type="checkbox" id="checkDate" onclick="buttonCheckDate()">
            <label for="checkDate"> Przedział czasowy </label>
        </div>

        <div>
            <label for="start">Data rozpoczęcia:</label>
            <input type="date" id="start" name="start">
        </div>
        <div>
            <label for="end">Data zakończenia:</label>
            <input type="date" id="end" name="end">
        </div>

    </div>
</form>
</body>
</html>
<script type="text/javascript" src="autocomplete.js"></script>
<script type="text/javascript" src="eventJsonToArrayOfNames.js"></script>
<script>
    orgBool = new Boolean(true);
    eveBool = new Boolean(true);
    dateBool = new Boolean(false);

    document.getElementById("phrase").addEventListener("keyup", myFunction);

    function myFunction() {
        if (document.getElementById("phrase").textLength > 2) {
            arr2 = [];
            eventJsonToArrayOfNames($(document).ready(function () {
                var str1 = "http://localhost:8080/api/search/eve/";

                if (orgBool == true && eveBool == true) {
                    str1 = "http://localhost:8080/api/search/eve-org/";
                } else if (orgBool == false && eveBool == true) {
                    str1 = "http://localhost:8080/api/search/eve/";
                } else if (orgBool == true && eveBool == false) {
                    str1 = "http://localhost:8080/api/search/org/";
                }
                if (dateBool == true) {
                    str1.concat(document.getElementById("start").value);
                    console.log(document.getElementById("start").value);
                    str1.concat(" 00:00:00/");
                    str1.concat(document.getElementById("end").value);
                    str1.concat(" 23:59:59")
                    console.log(document.getElementById("end").value);
                }

                var str2 = document.getElementById("phrase").value;
                var res = str1.concat(str2);

                $.ajax({
                    url: res,
                    type: "GET",
                    success: function (result) {
                        console.log('Success in converting data');
                        results = result;
                    },
                    error: function (error) {
                        console.log(error);
                    }
                })
            }));

            autocomplete(document.getElementById("phrase"), results, arr2);
        }
    }

    function buttonCheckOrg() {
        var checkBox = document.getElementById("checkOrg");
        if (checkBox.checked == true) {
            console.log('Organizers filtering is on');
            orgBool = true;
        } else {
            console.log('Organizers filtering is off');
            orgBool = false;
        }
    }

    function buttonCheckEve() {
        var checkBox = document.getElementById("checkEve");
        if (checkBox.checked == true) {
            console.log('Event names filtering is on');
            eveBool = true;
        } else {
            console.log('Event names filtering is off');
            eveBool = false;
        }
    }

    function buttonCheckDate() {
        var checkBox = document.getElementById("checkDate");
        if (checkBox.checked == true) {
            console.log('Date filtering is on');
            dateBool = true;
        } else {
            console.log('Date filtering is off');
            dateBool = false;
        }
    }

</script>
